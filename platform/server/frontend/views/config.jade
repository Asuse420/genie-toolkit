extends layout

block scripts
  script(src='/javascripts/qrcode.js')
  script(src='/javascripts/config.js')

block content
  h1 Configuration

  div.config-unit
    h2 Server
    p The server is up and running at #{server.name}, port #{server.port}.

    if server.initialSetup
      p.text-danger The server is in initial setup mode and thus open to
        |  all external access. Pair your phone now!

  div.config-unit
    h2 Cloud
    if cloud.configured
      p You successfully logged in with your cloud account.
      p Your cloud ID is <samp>#{cloud.id}</samp>
    else
      p You did not log in to a ThingEngine Cloud account. You can do it now.

      if cloud.error
        div.alert.alert-danger.alert-dismissible.fade.in(role='alert')
          button(type='button', data-dismiss='alert', aria-label="Close").close
            span(aria-hidden='true') Ã—

          p= cloud.error

      form(action='/config/cloud-setup', method='post').form-inline
        p
          span.form-group
            label(for='username').control-label Username
            input(type='text', name='username', value=cloud.username)#username.form-control

          span.form-group
            label(for='password').control-label Password
            input(type='password', name='password')#password.form-control

        p
          span.form-group
            button(type='submit').btn.btn-primary Log in

      p Don't have an account yet? 
        a(href='http://thingpedia.stanford.edu:8080/user/register') Register now!

  div.config-unit
    h2 Phone
    div#config-phone-desktop-browser
      p To configure your phone, you must visit the address 
        samp= server.address
        |  from a mobile browser.

      p Or you can scan this QR code:
        div#qrcode-target= qrcodeTarget
        div#qrcode-placeholder

    p#config-phone-mobile-browser(aria-hidden='true')
      a(href=qrcodeTarget).btn.btn-primary Configure